<div
    class="auto-card-updater-settings extension_settings"
    data-extension-name="AutoCardUpdaterExtension"
>
    <div class="inline-drawer">
        <div class="inline-drawer-toggle inline-drawer-header">
            <b><i class="fa-solid fa-address-card"></i> 角色卡自动更新-新特性</b>
            <div
                class="inline-drawer-icon fa-solid fa-circle-chevron-down down"
            ></div>
        </div>
        <div class="inline-drawer-content">
            <div class="description_text">
                一个自动更新角色卡描述的工具。插件作者: 默默 & Cline
            </div>

            <!-- 版本更新与联系方式区域 -->
            <div class="auto-card-updater-version-panel">
                <p>
                    当前版本:
                    <span id="auto-card-updater-current-version">0.0.0</span>
                </p>
                <button
                    id="auto-card-updater-check-for-updates"
                    class="menu_button"
                >
                    <i class="fa-solid fa-cloud-arrow-down"></i> 检查更新
                </button>
            </div>

            <hr />

            <!-- API 设置 -->
            <div class="inline-drawer">
                <div class="inline-drawer-toggle inline-drawer-header sub-header">
                    <b>API设置</b>
                    <div class="inline-drawer-icon fa-solid fa-circle-chevron-down down"></div>
                </div>
                <div class="inline-drawer-content">
                    <div class="description_text">
                        <b>安全提示:</b> API密钥将保存在浏览器本地存储中。
                    </div>
                    
                    <!-- 配置选择器 -->
                    <div class="setting_item">
                        <label for="autoCardUpdater-config-selector">选择配置:</label>
                        <div class="auto_card_updater_input_with_button">
                            <select id="autoCardUpdater-config-selector" class="text_pole">
                                <option value="">请选择配置</option>
                            </select>
                            <button id="autoCardUpdater-add-config" class="menu_button">
                                <i class="fa-solid fa-plus"></i> 新增
                            </button>
                            <button id="autoCardUpdater-delete-config" class="menu_button">
                                <i class="fa-solid fa-trash"></i> 删除
                            </button>
                        </div>
                    </div>
                    
                    <!-- 配置名称 -->
                    <div class="setting_item">
                        <label for="autoCardUpdater-config-name">配置名称:</label>
                        <input type="text" id="autoCardUpdater-config-name" class="text_pole" placeholder="例如：OpenAI GPT-4" />
                    </div>
                    
                    <!-- API配置表单 -->
                    <label for="autoCardUpdater-api-url">API基础URL:</label>
                    <input type="text" id="autoCardUpdater-api-url" class="text_pole" />
                    
                    <label for="autoCardUpdater-api-key">API密钥(可选):</label>
                    <input type="password" id="autoCardUpdater-api-key" class="text_pole" />
                    
                    <label for="autoCardUpdater-api-model">选择模型:</label>
                    <div class="auto_card_updater_input_with_button">
                        <select id="autoCardUpdater-api-model" class="text_pole"></select>
                        <button id="autoCardUpdater-load-models" class="menu_button">
                            <i class="fa-solid fa-cloud-download"></i> 加载模型
                        </button>
                    </div>
                    
                    <div id="autoCardUpdater-api-status" class="description_text"></div>
                    
                    <div class="button-group">
                        <button id="autoCardUpdater-save-config" class="menu_button wide_button">
                            <i class="fa-solid fa-floppy-disk"></i> 保存配置
                        </button>
                        <button id="autoCardUpdater-test-config" class="menu_button wide_button">
                            <i class="fa-solid fa-vial"></i> 测试连接
                        </button>
                    </div>
                    
                    <!-- 配置列表 -->
                    <hr />
                    <div class="setting_item">
                        <span>已保存的配置:</span>
                        <div id="autoCardUpdater-config-list" class="description_text" style="margin-top: 10px;"></div>
                    </div>
                </div>
            </div>

            <!-- 提示词设置 -->
            <div class="inline-drawer">
                <div
                    class="inline-drawer-toggle inline-drawer-header sub-header"
                >
                    <b>提示词设置</b>
                    <div
                        class="inline-drawer-icon fa-solid fa-circle-chevron-down down"
                    ></div>
                </div>
                <div class="inline-drawer-content">
                    <label for="autoCardUpdater-break-armor-prompt-textarea"
                        >破甲预设:</label
                    >
                    <textarea
                        id="autoCardUpdater-break-armor-prompt-textarea"
                        class="text_pole"
                        rows="5"
                    ></textarea>
                    <div class="button-group">
                        <button
                            id="autoCardUpdater-save-break-armor-prompt"
                            class="menu_button wide_button"
                        >
                            保存破甲预设
                        </button>
                        <button
                            id="autoCardUpdater-reset-break-armor-prompt"
                            class="menu_button wide_button"
                        >
                            恢复默认
                        </button>
                    </div>
                    <hr />
                    <label for="autoCardUpdater-char-card-prompt-textarea"
                        >角色卡预设:</label
                    >
                    <textarea
                        id="autoCardUpdater-char-card-prompt-textarea"
                        class="text_pole"
                        rows="8"
                    ></textarea>
                    <div class="button-group">
                        <button
                            id="autoCardUpdater-save-char-card-prompt"
                            class="menu_button wide_button"
                        >
                            保存角色卡预设
                        </button>
                        <button
                            id="autoCardUpdater-reset-char-card-prompt"
                            class="menu_button wide_button"
                        >
                            恢复默认
                        </button>
                    </div>
                </div>
            </div>

            <!-- 功能设置 -->
            <div class="inline-drawer">
                <div
                    class="inline-drawer-toggle inline-drawer-header sub-header"
                >
                    <b>更新所有角色描述</b>
                    <div
                        class="inline-drawer-icon fa-solid fa-circle-chevron-down down"
                    ></div>
                </div>
                <div class="inline-drawer-content">
                    <div class="setting_item">
                        <label for="autoCardUpdater-auto-update-threshold"
                            >AI读取上下文层数 (M)</label
                        >
                        <input
                            type="number"
                            id="autoCardUpdater-auto-update-threshold"
                            class="text_pole"
                            style="width: 80px"
                            min="1"
                            max="100"
                        />
                    </div>
                    <div class="setting_item">
                        <label for="autoCardUpdater-auto-update-offset"
                            >触发偏移量 (X)</label
                        >
                        <input
                            type="number"
                            id="autoCardUpdater-auto-update-offset"
                            class="text_pole"
                            style="width: 80px"
                            min="0"
                            max="50"
                        />
                    </div>
                    <div class="button-group">
                        <button
                            id="autoCardUpdater-save-auto-update-threshold"
                            class="menu_button wide_button"
                        >
                            保存上下文层数
                        </button>
                        <button
                            id="autoCardUpdater-save-auto-update-offset"
                            class="menu_button wide_button"
                        >
                            保存偏移量
                        </button>
                    </div>

                    <hr />

                    <div class="setting_item">
                        <span>启用自动更新所有角色卡</span>
                        <div class="SillyTavernSwitch">
                            <input
                                id="autoCardUpdater-auto-update-enabled-checkbox"
                                type="checkbox"
                            />
                            <div class="SillyTavernSlider"></div>
                        </div>
                    </div>
                    <div class="description_text">
                        当新消息数量达到(M+X)值时，将自动调用AI更新角色卡。其中M为上下文层数，X为偏移量。
                    </div>

                    <hr />

                    <div class="setting_item">
                        <span>手动更新</span>
                        <button
                            id="autoCardUpdater-manual-update-card"
                            class="menu_button"
                        >
                            <i class="fa-solid fa-bolt"></i> 立即更新
                        </button>
                    </div>
                    <div
                        id="autoCardUpdater-card-update-status-display"
                        class="description_text"
                    ></div>
                    <div
                        id="autoCardUpdater-total-messages-display"
                        class="description_text"
                    ></div>

                    <hr />

                    <div class="setting_item">
                        <span>启用角色卡查看器浮动按钮</span>
                        <div class="SillyTavernSwitch">
                            <input
                                id="char-card-viewer-enabled-checkbox"
                                type="checkbox"
                            />
                            <div class="SillyTavernSlider"></div>
                        </div>
                    </div>
                    <div class="description_text">
                        在主界面显示一个可拖动的按钮，点击可查看当前角色的核心数据。
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
